<!DOCTYPE html>

<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->

<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->

<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->

<!-- BEGIN HEAD -->

<head>

    <meta charset="utf-8" />

    <title>FoF Easy | API Request History</title>

    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <meta content="" name="description" />

    <meta content="詹靖华,周汪劲" name="author" />

    <!-- BEGIN GLOBAL MANDATORY STYLES -->

    <link href="../static/media/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>

    <link href="../static/media/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>

    <link href="../static/media/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>

    <link href="../static/media/css/style-metro.css" rel="stylesheet" type="text/css"/>

    <link href="../static/media/css/style.css" rel="stylesheet" type="text/css"/>

    <link href="../static/media/css/style-responsive.css" rel="stylesheet" type="text/css"/>

    <link href="../static/media/css/default.css" rel="stylesheet" type="text/css" id="style_color"/>

    <link href="../static/media/css/uniform.default.css" rel="stylesheet" type="text/css"/>

    <!-- END GLOBAL MANDATORY STYLES -->

    <!-- BEGIN PAGE LEVEL STYLES -->

    <link rel="stylesheet" type="text/css" href="../static/media/css/select2_metro.css" />

    <link rel="stylesheet" href="../static/media/css/DT_bootstrap.css" />

    <!-- END PAGE LEVEL STYLES -->

    <link rel="shortcut icon" href="../static/media/image/favicon.ico" />

    <script src="https://a.alipayobjects.com/g/datavis/g2/2.2.0/g2.js"></script>

</head>

<!-- END HEAD -->

<!-- BEGIN BODY -->

<body class="page-header-fixed">

    <!-- BEGIN HEADER -->

    <div class="header navbar navbar-inverse navbar-fixed-top">

        <!-- BEGIN TOP NAVIGATION BAR -->

        <div class="navbar-inner">

            <div class="container-fluid">

                <!-- BEGIN LOGO -->

                <a class="brand" href="index.html">

                <img src="../static/media/image/logo_fofeasy.png" alt="logo" />

                </a>

                <!-- END LOGO -->

                <!-- BEGIN RESPONSIVE MENU TOGGLER -->

                <a href="javascript:;" class="btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">

                <img src="../static/media/image/menu-toggler.png" alt="" />

                </a>          

                <!-- END RESPONSIVE MENU TOGGLER -->            

                <!-- BEGIN TOP NAVIGATION MENU -->
                <ul class="nav pull-right">

				<a href="{% url 'logout' %}" class="btn black">Log Out</a>

				</ul>
                <!-- END TOP NAVIGATION MENU --> 

            </div>

        </div>

        <!-- END TOP NAVIGATION BAR -->

    </div>

    <!-- END HEADER -->

    <!-- BEGIN CONTAINER -->

    <div class="page-container row-fluid">

        <!-- BEGIN SIDEBAR -->

        <div class="page-sidebar nav-collapse collapse">

            <!-- BEGIN SIDEBAR MENU -->        

            <ul class="page-sidebar-menu">

                <li>

                    <!-- BEGIN SIDEBAR TOGGLER BUTTON -->

                    <div class="sidebar-toggler hidden-phone"></div>

                    <!-- BEGIN SIDEBAR TOGGLER BUTTON -->

                </li>

                <li>

                    <!-- BEGIN RESPONSIVE QUICK SEARCH FORM -->

                    <form class="sidebar-search">

                        <div class="input-box">

                            <a href="javascript:;" class="remove"></a>

                            <input type="text" placeholder="Search..." />

                            <input type="button" class="submit" value=" " />

                        </div>

                    </form>

                    <!-- END RESPONSIVE QUICK SEARCH FORM -->

                </li>
                <li class="active start">

                    <a href="javascript:;">

                    <i class="icon-th"></i>

                    <span class="title">数据库后台</span>


                    <!--<span class="arrow open"></span>-->

                    </a>

                    <ul class="sub-menu">

                        <li >

                            <a href="{% url 'sql_history' %}">

                            SQL History</a>

                        </li>

                        <li>

                            <a href="{% url 'date_static' %}">

                            Date Statistics</a>

                        </li>

                    </ul>
                    <a href="{% url 'fofeasy_home' %}" >

                    <i class="icon-th"></i>

                    <span class="title" >FOF Easy后台</span>
						<span class="selected"></span>

<!--<a href="{% url 'fofeasy_home' %}"></a>-->
                    <!--<span class="selected"></span>-->

                    <!--<span class="arrow close"></span>-->

                    </a>
                        <!--<li>-->

                            <!--<a href="{% url 'fofeasy_home' %}">-->

                            <!--跳转至FOF Easy用户API后台</a>-->

                        <!--</li>-->
                </li>
            </ul>

            <!-- END SIDEBAR MENU -->

        </div>

        <!-- END SIDEBAR -->

        <!-- BEGIN PAGE -->

        <div class="page-content">

            <!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->

            <div id="portlet-config" class="modal hide">

                <div class="modal-header">

                    <button data-dismiss="modal" class="close" type="button"></button>

                    <h3>portlet Settings</h3>

                </div>

                <div class="modal-body">

                    <p>Here will be a configuration form</p>

                </div>

            </div>

            <!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->

            <!-- BEGIN PAGE CONTAINER-->        

            <div class="container-fluid">

                <!-- BEGIN PAGE HEADER-->

                <div class="row-fluid">

                    <div class="span12">

                        <!-- BEGIN STYLE CUSTOMIZER -->

                        <div class="color-panel hidden-phone">

                            <div class="color-mode-icons icon-color"></div>

                            <div class="color-mode-icons icon-color-close"></div>

                            <div class="color-mode">

                                <p>THEME COLOR</p>

                                <ul class="inline">

                                    <li class="color-black current color-default" data-style="default"></li>

                                    <li class="color-blue" data-style="blue"></li>

                                    <li class="color-brown" data-style="brown"></li>

                                    <li class="color-purple" data-style="purple"></li>

                                    <li class="color-grey" data-style="grey"></li>

                                    <li class="color-white color-light" data-style="light"></li>

                                </ul>

                                <label>

                                    <span>Layout</span>

                                    <select class="layout-option m-wrap small">

                                        <option value="fluid" selected>Fluid</option>

                                        <option value="boxed">Boxed</option>

                                    </select>

                                </label>

                                <label>

                                    <span>Header</span>

                                    <select class="header-option m-wrap small">

                                        <option value="fixed" selected>Fixed</option>

                                        <option value="default">Default</option>

                                    </select>

                                </label>

                                <label>

                                    <span>Sidebar</span>

                                    <select class="sidebar-option m-wrap small">

                                        <option value="fixed">Fixed</option>

                                        <option value="default" selected>Default</option>

                                    </select>

                                </label>

                                <label>

                                    <span>Footer</span>

                                    <select class="footer-option m-wrap small">

                                        <option value="fixed">Fixed</option>

                                        <option value="default" selected>Default</option>

                                    </select>

                                </label>

                            </div>

                        </div>

                        <!-- END BEGIN STYLE CUSTOMIZER -->  

                        <!-- BEGIN PAGE TITLE & BREADCRUMB-->

                        <h3 class="page-title">

                            {{date}} {{company}} 请求记录

                        </h3>

                        <ul class="breadcrumb">

                            <li>

                                <i class="icon-home"></i>

                                <a href="{% url 'fofeasy_home'%}">Home</a>

                                <i class="icon-angle-right"></i>

                            </li>

                            <li>

                                <a href="{% url 'fofeasy_user_detail' user_id=user %}">{{company}}</a>

                                <i class="icon-angle-right"></i>

                            </li>
                            <li>

                                <a href="{% url 'fofeasy_date_detail' date=date %}">{{date}}</a>

                            </li>
                        </ul>

                        <!-- END PAGE TITLE & BREADCRUMB-->

                    </div>

                </div>

                <!-- END PAGE HEADER-->

                <!-- BEGIN PAGE CONTENT-->

                <div class="row-fluid profile">

                    <div class="span12">

                        <!--BEGIN TABS-->

                        <div class="tabbable tabbable-custom tabbable-full-width">

                            <ul class="nav nav-tabs">

                                <li class="active"><a href="#tab_1_1" data-toggle="tab">数据表</a></li>

                                <li><a href="#tab_1_2" data-toggle="tab">统计图</a></li>

                            </ul>

                            <div class="tab-content">

                                <div class="tab-pane row-fluid active" id="tab_1_1">
                                    
                                    <!-- BEGIN EXAMPLE TABLE PORTLET-->

                                    <div class="portlet box green">

                                        <div class="portlet-title">

                                            <div class="caption"><i class="icon-eye-open"></i><b>{{date}}</b> {{company}} API请求记录</div>

                                            <div class="tools">

                                                <a href="javascript:;" class="collapse"></a>

                                                <a href="#portlet-config" data-toggle="modal" class="config"></a>

                                                <a href="javascript:;" class="reload"></a>

                                                <a href="javascript:;" class="remove"></a>

                                            </div>

                                        </div>
                                        <div class="portlet-body">
                                            <li> 当日请求次数：<b>{{sum_api}}</b></li>

                                            <table class="table table-striped table-hover table-bordered" id="sql_history_1">
                                            <thread>
                                                <tr>
                                                    <th>用户</th>
                                                    <th>IP地址</th>
                                                    <th>访问时间</th>
                                                    <th>API</th>
                                                    <th>API请求</th>
                                                </tr>
                                            </thread>
                                            <tobody>
                                                {% for post in posts %}
                                                <tr>
                                                    <td>{{post.company}}</td>
                                                    <td>{{post.ip_address}}</td>
                                                    <td>{{post.action_time|date:"Y年m月d日 H:i:s"}}</td>
                                                    <td>{{post.api}}</td>
                                                    <td>{{post.user_action}}</td>
                                                </tr>
                                                {% endfor %}
                                            </tobody>
                                            </table>
                                        </div>

                                    </div>

                                    <!-- END EXAMPLE TABLE PORTLET-->

                                </div>

                                <div class="tab-pane row-fluid" id="tab_1_2">
                                    
                                    <!-- BEGIN EXAMPLE TABLE PORTLET-->

                                    <div class="portlet box blue">

                                        <div class="portlet-title">

                                            <div class="caption"><i class="icon-eye-open"></i><b>{{date}}</b> {{company}} API请求分布统计图</div>

                                            <div class="tools">

                                                <a href="javascript:;" class="collapse"></a>

                                                <a href="#portlet-config" data-toggle="modal" class="config"></a>

                                                <a href="javascript:;" class="reload"></a>

                                                <a href="javascript:;" class="remove"></a>

                                            </div>

                                        </div>

                                        <div class="portlet-body">
                                        <div id = "c1"></div>
                                        <script>
                                            var post = {{post1|safe}};
                                            var Stat = G2.Stat;
                                            var chart = new G2.Chart({
                                                id: 'c1', // 指定图表容器 ID
                                                width: 800, // 指定图表宽度
                                                height : 400 // 指定图表高度
                                            });
                                            chart.source(post, {
                                                user_action: {
                                                    alias: 'API'
                                                },
                                                sum_api: {
                                                    alias: '次数'
                                                }
                                            });
                                            chart.coord('theta', {
                                                radius: 0.8 // 设置饼图的大小
                                            });
                                            chart.legend(false);
                                            chart.tooltip({
                                                title: null,
                                                map: {
                                                  value: 'sum_api'
                                                }
                                            });
                                            chart.intervalStack()
                                                .position(Stat.summary.percent('sum_api'))
                                                .color('user_action')
                                                .label('user_action*..percent',function(user_action, percent){
                                                percent = (percent * 100).toFixed(2) + '%';
                                                return user_action + ' ' + percent;
                                            });
                                            chart.render();
                                            var geom = chart.getGeoms()[0]; // 获取所有的图形
                                            var items = geom.getData(); // 获取图形对应的数据
                                            geom.setSelected(items[1]); // 设置选中
                                        </script>
                                        </div>

                                    </div>

                                    <!-- END EXAMPLE TABLE PORTLET-->

                                </div>

                            </div>

                        </div>

                    </div>

                </div>

                <!-- END PAGE CONTENT -->

            </div>

            <!-- END PAGE CONTAINER-->

        </div>

        <!-- END PAGE -->

    </div>

    <!-- END CONTAINER -->

    <!-- BEGIN FOOTER -->

    <div class="footer">

        <div class="footer-inner">

            2016 &copy; Fofpower Inc.
            
        </div>

        <div class="footer-tools">

            <span class="go-top">

            <i class="icon-angle-up"></i>

            </span>

        </div>

    </div>

    <!-- END FOOTER -->

    <!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->

    <!-- BEGIN CORE PLUGINS -->

    <script src="../static/media/js/jquery-1.10.1.min.js" type="text/javascript"></script>

    <script src="../static/media/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>

    <!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->

    <script src="../static/media/js/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>      

    <script src="../static/media/js/bootstrap.min.js" type="text/javascript"></script>

    <!--[if lt IE 9]>

    <script src="../static/media/js/excanvas.min.js"></script>

    <script src="../static/media/js/respond.min.js"></script>  

    <![endif]-->   

    <script src="../static/media/js/jquery.slimscroll.min.js" type="text/javascript"></script>

    <script src="../static/media/js/jquery.blockui.min.js" type="text/javascript"></script>  

    <script src="../static/media/js/jquery.cookie.min.js" type="text/javascript"></script>

    <script src="../static/media/js/jquery.uniform.min.js" type="text/javascript" ></script>

    <!-- END CORE PLUGINS -->

    <!-- BEGIN PAGE LEVEL PLUGINS -->

    <script type="text/javascript" src="../static/media/js/select2.min.js"></script>

    <script type="text/javascript" src="../static/media/js/jquery.dataTables.js"></script>

    <script type="text/javascript" src="../static/media/js/DT_bootstrap.js"></script>

    <!-- END PAGE LEVEL PLUGINS -->

    <!-- BEGIN PAGE LEVEL SCRIPTS -->

    <script src="../static/media/js/app.js"></script>

    <script src="../static/media/js/table-editable.js"></script> 

    <script>

        jQuery(document).ready(function() {       

           App.init();

           TableEditable.init();

        });

    </script>

<script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-37564768-1']);  _gaq.push(['_setDomainName', 'keenthemes.com']);  _gaq.push(['_setAllowLinker', true]);  _gaq.push(['_trackPageview']);  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();
</script>
</body>

<!-- END BODY -->

</html>